<!DOCTYPE html>
<!-- this page is for getting the slide url -->
<html>

<head>
  <base target="_top">
  <?!= include('stylesheet'); ?>
  <script>

    function changePage(page) {
      console.log("changePage")
      document.open();
      document.write(page);
      document.close();
    }

    function toLoading(res) {
      console.log("toLoading")
      google.script.run.withSuccessHandler(changePage).newPage('loading');
    }

    function showError(msg, element) {
      alert(msg)
    }

    // passing the url to gs, and direct to loading page
    function saveUrl() {
      console.log("saveURL")
      let slideUrl = document.getElementById("slideId").value;
      console.log(typeof(slideUrl));
      google.script.run.withSuccessHandler(toLoading)
            .withFailureHandler(showError).saveSlideID(slideUrl);
     

    }

    function test() {  
      google.script.run.withSuccessHandler().showDialog();

    }


    function makeCopy() {
      google.script.run.withSuccessHandler().makeWorkSheet();
    }

  </script>
</head>


<body class="landing">
  <!-- below line need to delete after test -->
  <!-- <button onclick="test()">Test</button>
  <button onclick="makeCopy()">Copy</button> -->


  <h1>Hello!</h1>
  <div class="landing-instructions">Enter the source URL of your Google slide deck below.</div>
  <form class='form-group'>
    <div>
      <label>source URL</label>
      <input type="text" name="slideID" id="slideId">
    </div>
    <button class="btn btn-green" id="fetch-slide" onclick="saveUrl()">enter</button>
  </form>
  <p>Getting an error? Visit our <a href=https://www.notion.so/mims22/Welcome-to-MateriALL-3097e43760aa424cbd3a6563138f1334>support page</a> to see what kinds of content sources you can use.</p>

</body>
</html>
