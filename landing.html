<!DOCTYPE html>
<!-- this page is for getting the slide url -->
<html>

<head>
  <base target="_top">
  <?!= include('stylesheet'); ?>

  <script>
    // changes page
    function changePage(page) {
      document.open();
      document.write(page);
      document.close();
    }

    // changes to loading
    function toLoading(res) {
      google.script.run.withSuccessHandler(changePage).newPage('loading');
    }

    // shows returned error
    function showError(msg, element) {
      alert(msg)
    }

    // passes the url to gs, and directs to loading page
    function saveUrl() {
      let slideUrl = document.getElementById("slideId").value;
      google.script.run.withSuccessHandler(toLoading)
            .withFailureHandler(showError).saveSlideID(slideUrl);
    }

    // opens a new broswer window for support page
    function openPage() {
      window.open("https://mims22.notion.site/Welcome-to-MateriALL-3097e43760aa424cbd3a6563138f1334", '_blank', 'location=yes,height=600,width=520,scrollbars=yes,status=yes');
    }

    // function test() {  
    //   google.script.run.withSuccessHandler().showDialog();
    // }

    // function makeCopy() {
    //   google.script.run.withSuccessHandler().makeWorkSheet();
    // }



  </script>
</head>


<body class="landing">
  <!-- below line need to delete after test -->
  <!-- <button onclick="test()">Test</button>
  <button onclick="makeCopy()">Copy</button> -->

  <h1>Hello!</h1>
  <div class="landing-instructions">Enter the source URL of your Google slide deck below.</div>
  <form class='form-group'>
    <div>
      <label>source URL</label>
      <input type="text" name="slideID" id="slideId">
    </div>
    <button class="btn btn-green" id="fetch-slide" onclick="saveUrl()">enter</button>
  </form>
  <p>Getting an error? Visit our <a onclick="openPage()" class="support-btn">support page</a> to see what kinds of content sources you can use.</p>

</body>
</html>
